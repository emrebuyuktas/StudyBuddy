@page "/test"
@using StudyBuddy.WebUi.Models
@using StudyBuddy.Application.Dtos
@using System.Net.Http.Headers
<h3>Deneme</h3>
<style>
    body {
        background-color: #eee
    }
    
    .card {
        border: none;
        border-radius: 10px
    }
    
    .c-details span {
        font-weight: 300;
        font-size: 13px
    }
      
    .badge span {
        background-color: #0dcaf0;
        width: 60px;
        height: 25px;
        padding-bottom: 3px;
        border-radius: 5px;
        display: flex;
        color: #0c63e4;
        justify-content: center;
        align-items: center
    }
    
    .progress {
        height: 10px;
        border-radius: 10px
    }
    
    .progress div {
        background-color: red
    }
    
    .text1 {
        font-size: 14px;
        font-weight: 600
    }
    
    .text2 {
        color: #a5aec0
    }
</style>
<div class="container mt-5 mb-3">
<div class="row">
@foreach (var item in _classroomListDtos)
{
    
        
            <div class="col-md-4">
                <div class="card p-3 mb-2">
                    <div class="d-flex justify-content-between">
                        <div class="d-flex flex-row align-items-center">
                            <div class="ms-2 c-details">
                                <h6 class="mb-0">@item.Id</h6> 
                            </div>
                        </div>
                        <div class="badge">
                            <button class="btn btn-info btn-block" id="inputPassword3" >Save</button>
                        </div>
                    </div>
                    <div class="mt-5">
                        <h3 class="heading">@item.Name<br>Designer-Singapore</h3>
                        <div class="mt-5">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="mt-3">
                                <span class="text1">32 Applied <span class="text2">of 50 capacity</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        
        
    
}
</div>
</div>
@code {
    [CascadingParameter]
    IModalService Modal { get; set; }

    [Inject]
    HttpClient? Client { get; set; }

    [Inject]
    NavigationManager? NavManager { get; set; }

    [Inject]
    ModalManager? ModalManager { get; set; }

    [Inject]
    ILocalStorageService? LocalStorageService { get; set; }
    
    List<ClassroomListDto> _classroomListDtos=new ();


    


    String loadingMessage = "Loading...";

    protected override async Task OnInitializedAsync()
    {
        var token= await LocalStorageService.GetItemAsync<string>("token");
        
        Client.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", token);
        
        var httpRequest = (await Client.GetServiceResponseAsync<List<ClassroomListDto>>("https://localhost:7042/api/Classroom/related", true));

        Console.WriteLine(httpRequest.StatusCode);
        
        
        if (httpRequest.StatusCode != 200)
        {
            Console.WriteLine(httpRequest.Error.Errors.First());
        }
        else
        {
            _classroomListDtos = httpRequest.Data;
            foreach (var item in httpRequest.Data)
            {
                Console.WriteLine(item.Name);

            }
            
        }
    }
    
}